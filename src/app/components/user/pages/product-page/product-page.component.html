<p-toast/>
<section id="products" class="section">
  <div class="container">
    <div class="row">
      <!-- Sidebar -->
      <div class="col-12">
        <div class="search-box row align-items-center d-flex justify-content-between mb-3">
            <input id="searchField" type="text" placeholder="Nhập thông tin sản phẩm...">
            <button id="searchBtn">Tìm kiếm</button>
        </div>
      </div>
      <!-- Main Content -->
      <div class="col-3">
        <aside id="sidebar" class="sidebar" th:fragment="sidebar">

          <ul class="sidebar-nav" id="sidebar-nav">

            <li class="nav-item">
              <a class="nav-link " href="index.html">
                <i class="bi bi-grid"></i>
                <span>Dashboard</span>
              </a>
            </li><!-- End Dashboard Nav -->

            <li class="nav-item">
              <a class="nav-link collapsed" data-bs-target="#components-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-menu-button-wide"></i><span>Thêm dữ liệu</span><i class="bi bi-chevron-down ms-auto"></i>
              </a>
              <ul id="components-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
                <li>
                  <a href="">
                    <i class="bi bi-circle"></i><span>Sản phẩm</span>
                  </a>
                </li>
                <li>
                  <a href="components-accordion.html">
                    <i class="bi bi-circle"></i><span>Hãng cung cấp</span>
                  </a>
                </li>
              </ul>
            </li><!-- End Components Nav -->

            <li class="nav-item">
              <a class="nav-link collapsed" data-bs-target="#tables-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-layout-text-window-reverse"></i><span>Quản lý dữ liệu</span><i
                class="bi bi-chevron-down ms-auto"></i>
              </a>
              <ul id="tables-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
                <li>
                  <a th:href="@{/admin/products}">
                    <i class="bi bi-circle"></i><span>Sản phẩm</span>
                  </a>
                </li>
              </ul>
            </li><!-- End Tables Nav -->

            <li class="nav-item">
              <a class="nav-link collapsed" data-bs-target="#icons-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-gem"></i><span>Icons</span><i class="bi bi-chevron-down ms-auto"></i>
              </a>
              <ul id="icons-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
                <li>
                  <a href="icons-bootstrap.html">
                    <i class="bi bi-circle"></i><span>Bootstrap Icons</span>
                  </a>
                </li>
              </ul>
            </li><!-- End Icons Nav -->

          </ul>
        </aside><!-- End Sidebar-->
      </div>
      <div class="col-9">
        <div class="row">
          <div class="col-12">
            <div class="button-container" role="group">
              <button class="btn" #btn1 (click)="setActive(btn1); onTotalProductsPage()">Tất cả sản phẩm</button>
              <button class="btn" #btn2 (click)="setActive(btn2); onLatestProductsPage()">Mới nhất</button>
              <button class="btn" #btn3 (click)="setActive(btn3); onBestSellerProductsPage()">Bán chạy nhất</button>
              <button class="btn" #btn4 (click)="setActive(btn4); onSortedByAscPricePage()">Giắ thấp đến cao</button>
              <button class="btn" #btn5 (click)="setActive(btn5); onSortedByDescPricePage()">Giá cao đến thấp</button>
            </div>
          </div>
          <div class="product-container"
               infiniteScroll
               [infiniteScrollDistance]="2"
               [infiniteScrollThrottle]="50"
               (scrolled)="loadMoreProducts()"
               [scrollWindow]="false">
            <div class="row">
              @for (item of products; track item.id){
                <div class="col-md-3 col-sm-4 mb-3 pro-d">
                  <div class="product-grid">
                    <div class="product-image">
                      <a [routerLink]="['/products', item.id ]" class="image">
                        <img src="{{ item.image }}" class="img-fluid zoom" alt="book-1">
                      </a>
                      <span  class="product-discount-label">10%</span>
                      <p-confirmPopup #cp>
                        <ng-template pTemplate="headless" let-message let-test>
                          <div class="border-round p-3">
                            <span>{{ message.message }}</span>
                            <div class="flex align-items-center gap-2 mt-3">
                              <p-button (onClick)="accept(item.id)" label="Xác nhận" size="small" class="me-2"/>
                              <p-button (onClick)="reject()" label="Hủy" [outlined]="true" size="small" />
                            </div>
                          </div>
                        </ng-template>
                      </p-confirmPopup>
                      <ul class="product-links">
                        <li><a (click)="confirm($event); setCurrentId(item.id)"><i class="bi bi-cart-plus"></i></a></li>
                        <li><a href="#"><i class="bi bi-heart"></i></a></li>
                        <li><a href="#"><i class="bi bi-shuffle"></i></a></li>
                      </ul>
                      <a [routerLink]="['/products', item.id]" class="add-to-cart">Xem chi tiết</a>
                    </div>
                    <div class="product-content">
                      <h3 class="title"><a href="#"> {{ item.name }} </a></h3>
                      <div class="price"> {{ item.price | currency:'VND':'symbol':'1.0-0' }} </div>
                      <input type="hidden" class="dis-price"/>
                      <p-rating [ngModel]="item.evaluate" [stars]="5" />
                    </div>
                  </div>
                </div>
              } @empty {
              }
            </div>
          </div>
          <div class="card">
            <p-dataview #dv [value]="products" [layout]="layout">
              <ng-template #grid let-items>
                <div class="grid grid-cols-12 gap-4">
                  <div
                    *ngFor="let i of counterArray(6); let first = first"
                    class="col-12 col-sm-6 col-xl-4 p-2 d-flex"
                  >
                    <div
                      class="p-6 border border-surface-200 dark:border-surface-700 bg-surface-0 dark:bg-surface-900 rounded"
                    >
                      <div class="d-flex flex-wrap align-items-center justify-content-between gap-2">
                        <p-skeleton width="6rem" height="2rem" />
                        <p-skeleton width="3rem" height="1rem" />
                      </div>
                      <div class="d-flex flex-col align-items-center gap-4 py-8">
                        <p-skeleton height="10rem" class="w-3/4" styleClass="w-3/4" />
                        <p-skeleton width="8rem" height="2rem" />
                        <p-skeleton width="6rem" height="1rem" />
                      </div>
                      <div class="d-flex align-items-center justify-between">
                        <p-skeleton width="4rem" height="2rem" />
                        <p-skeleton
                          width="6rem"
                          height="1rem"
                          shape="circle"
                          size="3rem"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </ng-template>
            </p-dataview>
          </div>

        </div>
      </div>
    </div>
  </div>
</section>
